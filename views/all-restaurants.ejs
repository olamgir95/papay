<%- include('includes/header') %>

<link rel="stylesheet" href="/css/menu.css" />
<body>
  <div id="main_container">
    <div class="group_name">
      <ul class="nav justify-content-center">
        <li class="nav-item pointer">
          <a href="/resto" class="nav-link active">Home</a>
        </li>
        <li class="nav-item pointer">
          <a href="/resto/products/menu" class="nav-link active">MyResto</a>
        </li>
        <li class="nav-item pointer">
          <a href="/resto/logout" class="nav-link active">Logout</a>
        </li>
      </ul>
    </div>

    <div class="restaurant_menu_frame">
      <div class="restaurant_container">
        <div class="resto_table">
          <span class="new_dish_txt"> Barcha Restaurantlar Ro'yxati </span>
          <table class="table table-sm table-hover">
            <thead class="thead-light">
              <th scope="col">T/r</th>
              <th scope="col">Restaurant nomi</th>
              <th scope="col">Restaurant telefon raqami</th>
              <th scope="col">Restaurant top</th>
              <th scope="col">Restaurant holati</th>
            </thead>
            <% restaurant_data.map(function(value, key){ %>
            <tbody class="bg-white">
              <td><%= key+1%></td>
              <td><%= value.mb_nick%></td>
              <td><%= value.mb_phone%></td>
              <td style="width: 13%">
                <label class="switch">
                  <input type="checkbox" class="mb_top" id="<%= value._id%>" 
                  <%= value.mb_top ==="Y" ? "checked" : "" %> />
                  <span class="slider round"></span>
                </label>
              </td>
              <td style="width: 13%">
                <select class="spec_select mb_status" name="" id="">
                  <option value="ONPAUSE" <%= value.mb_status ==="ONPAUSE" ? "selected" : "" %> >ONPAUSE</option>
                  <option value="ACTIVE" <%= value.mb_status ==="ACTIVE" ? "selected" : "" %>>ACTIVE</option>
                  <option value="DELETED" <%= value.mb_status ==="DELETED" ? "selected" : "" %>>DELETED</option>
                </select>
              </td>
            </tbody>
            <% }); %>
          </table>
        </div>
      </div>
    </div>
  </div>

  <script>
    $(function () {
      $(".mb_top").on("change", function (e) {
        const id = e.target.id;
        const mb_top = e.target.checked ? "Y" : "N";
        axios
          .post("/resto/all-restaurant/edit", { id: id, mb_top: mb_top })
          .then((response) => {
            const result = response.data;
            if(result.state==='success') alert("successfully updated");
            else alert(result.message)
          })
          .catch((err) => console.log(err));
      });
    });
  </script>
</body>
<%- include('includes/footer') %>
